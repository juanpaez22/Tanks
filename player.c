//Player Module
//Define tank structs, move functions, fire function, etc.

#include <stdint.h>
#include "../inc/tm4c123gh6pm.h"
#include "ST7735.h"

const unsigned short Tank1[] = {
 0x5664, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0x5664, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0x0000, 0xE9CB,
 0x5664, 0x0000, 0xE9CB, 0xE9CB, 0xE9CB, 0x0000, 0xE9CB, 0xE9CB, 0x5664, 0x0000, 0x001F, 0xE9CB, 0x0000, 0xE9CB, 0xE9CB, 0xE9CB,
 0x5664, 0x0000, 0x001F, 0x001F, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0x5664, 0x0000, 0x001F, 0x001F, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB,
 0x5664, 0x0000, 0x001F, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0x5664, 0x0000, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB,
 0x5664, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB

};



const unsigned short Tank2[] = {
 0x5664, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0x5664, 0x0000, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB,
 0x5664, 0x0000, 0x0338, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0x5664, 0x0000, 0x0338, 0x0338, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB,
 0x5664, 0x0000, 0x0338, 0x0338, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0x5664, 0x0000, 0x0338, 0xE9CB, 0x0000, 0xE9CB, 0xE9CB, 0xE9CB,
 0x5664, 0x0000, 0xE9CB, 0xE9CB, 0xE9CB, 0x0000, 0xE9CB, 0xE9CB, 0x5664, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0x0000, 0xE9CB,
 0x5664, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB, 0xE9CB

};

typedef struct{
	const int x;
	int y;
	int health;
} tank_t;

tank_t tank1 = {61, 20, 100};
tank_t tank2 = {61, 145, 100};

void Delay100ms(uint32_t count){
	uint32_t volatile time;
  while(count>0){
    time = 727240;  // 0.1sec at 80 MHz
    while(time){
	  	time--;
    }
    count--;
  }
	
}

void TanksReset(void){
	tank1.y = 20;
	tank2.y = 145;
	tank1.health = 100;
	tank2.health = 100;
	
}

int Tank1GetPos(void){
	return tank1.y;
}

int Tank2GetPos(void){
	return tank2.y;
}

void Tank1Print(void){
	ST7735_DrawBitmap(tank1.x, tank1.y, Tank1, 8, 9);
}

void Tank2Print(void){
	ST7735_DrawBitmap(tank2.x, tank2.y, Tank2, 8, 9);
}


void Tank1MoveLeft(void){
	if (tank1.y>12){
		for (int i = 0; i<5; i++){
			tank1.y = tank1.y - 1;
			Delay100ms(1);
			Tank1Print();
		}
	}
	return;
}
void Tank2MoveLeft(void){
	if (tank2.y>132){
		for (int i = 0; i<5; i++){
			tank2.y = tank2.y - 1;
			Delay100ms(1);
			Tank2Print();
		}
	}
}
void Tank1MoveRight(void){
	if (tank1.y<35){
		for (int i = 0; i<5; i++){
			tank1.y = tank1.y + 1;
			Delay100ms(1);
			Tank1Print();
		}
	}
}

void Tank2MoveRight(void){
	if (tank2.y<154){
		for (int i = 0; i<5; i++){
			tank2.y = tank2.y + 1;
			Delay100ms(1);
			Tank2Print();
		}
	}
}

